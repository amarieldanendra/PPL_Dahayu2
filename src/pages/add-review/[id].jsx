import { useRouter } from "next/router"
import { useState, useEffect } from "react"
import { useSession } from "next-auth/react"
export default function AddReview(){
    const product = {
        productName: "AZARINE",
        productDesc: "Hydrasoothe Sunscreen Gel SPF 45 PA++++",
        productSize: 50,
        productImage: "/azarine.png" 
    }
    const {push,query} = useRouter()
    const [rating, setRating] = useState(0)
    const [review, setReview] = useState("")
    const [data, setData] = useState({})
    const {status} = useSession()
    useEffect(() => {
        if(status == "unauthenticated")  push("/login")
    },[])
    useEffect(() => {
        fetch("/api/products/"+query.id)
            .then(res => res.json())
            .then(res => setData(res))
    },[query])
    const onSubmit = () => {
        fetch("/api/addReview", {
            method: "POST",
            body: JSON.stringify({
                rating: rating,
                review: review,
                id: query.id
            })
        })
            .then(res => {
                if(res.ok){
                    alert("Tambah review sukses!!")
                    push("/select-product")
                }
            })
    }
    return(
        <main
            className="bg-[#F4EBD0] py-20 flex flex-col px-[75px]"
        >
            <h2
                className="font-dosis text-3xl text-[#023020] font-medium"
            >
                Give Review
            </h2>
            <div
                className="flex w-full mt-8"
            >
                <img className="aspect-square w-[200px]" src={data.productImg} alt="" />
                <div
                    className="ml-5 text-[#023020] font-dosis"
                >
                    <p className="font-bold text-2xl">{data.brand}</p>
                    <p className="text-2xl mt-5">{data.productName}</p>
                    <p className="text-2xl mt-5">{data.price}</p>
                    <p className="text-2xl mt-5">{data.productSize}</p>
                </div>
            </div>
            <div
                className="P-5 text-[#023020] font-inter mt-5 bg-[#FCF4DB] p-5 rounded-xl"
            >
                <p className="font-bold text-2xl">Give rating</p>
                <div
                    className="flex mt-3"
                >
                    <svg onClick={() => setRating(1)} className="cursor-pointer" width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.3165 27.2202C35.7337 27.785 35.466 28.6017 35.5987 29.4027L37.599 40.4727C37.7677 41.411 37.3717 42.3605 36.5865 42.9027C35.817 43.4652 34.7932 43.5327 33.954 43.0827L23.9887 37.8852C23.6422 37.7007 23.2575 37.6017 22.8637 37.5905H22.254C22.0425 37.622 21.8355 37.6895 21.6465 37.793L11.679 43.0152C11.1862 43.2627 10.6282 43.3505 10.0815 43.2627C8.74949 43.0107 7.86074 41.7417 8.07899 40.403L10.0815 29.333C10.2142 28.5252 9.9465 27.704 9.36374 27.1302L1.23899 19.2552C0.559494 18.596 0.323244 17.606 0.633744 16.7127C0.935244 15.8217 1.70474 15.1715 2.63399 15.0252L13.8165 13.403C14.667 13.3152 15.414 12.7977 15.7965 12.0327L20.724 1.93023C20.841 1.70522 20.9917 1.49823 21.174 1.32273L21.3765 1.16523C21.4822 1.04823 21.6037 0.951475 21.7387 0.872725L21.984 0.782725L22.3665 0.625225H23.3137C24.1597 0.712975 24.9045 1.21923 25.2937 1.97523L30.2865 12.0327C30.6465 12.7685 31.3462 13.2792 32.154 13.403L43.3365 15.0252C44.2815 15.1602 45.0712 15.8127 45.384 16.7127C45.6787 17.615 45.4245 18.605 44.7315 19.2552L36.3165 27.2202Z" fill={rating >= 1 ? "#FDDA0D" : "#777979"}/>
                    </svg>
                    <svg onClick={() => setRating(2)} className="ml-4 cursor-pointer" width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.3165 27.2202C35.7337 27.785 35.466 28.6017 35.5987 29.4027L37.599 40.4727C37.7677 41.411 37.3717 42.3605 36.5865 42.9027C35.817 43.4652 34.7932 43.5327 33.954 43.0827L23.9887 37.8852C23.6422 37.7007 23.2575 37.6017 22.8637 37.5905H22.254C22.0425 37.622 21.8355 37.6895 21.6465 37.793L11.679 43.0152C11.1862 43.2627 10.6282 43.3505 10.0815 43.2627C8.74949 43.0107 7.86074 41.7417 8.07899 40.403L10.0815 29.333C10.2142 28.5252 9.9465 27.704 9.36374 27.1302L1.23899 19.2552C0.559494 18.596 0.323244 17.606 0.633744 16.7127C0.935244 15.8217 1.70474 15.1715 2.63399 15.0252L13.8165 13.403C14.667 13.3152 15.414 12.7977 15.7965 12.0327L20.724 1.93023C20.841 1.70522 20.9917 1.49823 21.174 1.32273L21.3765 1.16523C21.4822 1.04823 21.6037 0.951475 21.7387 0.872725L21.984 0.782725L22.3665 0.625225H23.3137C24.1597 0.712975 24.9045 1.21923 25.2937 1.97523L30.2865 12.0327C30.6465 12.7685 31.3462 13.2792 32.154 13.403L43.3365 15.0252C44.2815 15.1602 45.0712 15.8127 45.384 16.7127C45.6787 17.615 45.4245 18.605 44.7315 19.2552L36.3165 27.2202Z" fill={rating >= 2 ? "#FDDA0D" : "#777979"}/>
                    </svg>
                    <svg onClick={() => setRating(3)} className="ml-4 cursor-pointer" width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.3165 27.2202C35.7337 27.785 35.466 28.6017 35.5987 29.4027L37.599 40.4727C37.7677 41.411 37.3717 42.3605 36.5865 42.9027C35.817 43.4652 34.7932 43.5327 33.954 43.0827L23.9887 37.8852C23.6422 37.7007 23.2575 37.6017 22.8637 37.5905H22.254C22.0425 37.622 21.8355 37.6895 21.6465 37.793L11.679 43.0152C11.1862 43.2627 10.6282 43.3505 10.0815 43.2627C8.74949 43.0107 7.86074 41.7417 8.07899 40.403L10.0815 29.333C10.2142 28.5252 9.9465 27.704 9.36374 27.1302L1.23899 19.2552C0.559494 18.596 0.323244 17.606 0.633744 16.7127C0.935244 15.8217 1.70474 15.1715 2.63399 15.0252L13.8165 13.403C14.667 13.3152 15.414 12.7977 15.7965 12.0327L20.724 1.93023C20.841 1.70522 20.9917 1.49823 21.174 1.32273L21.3765 1.16523C21.4822 1.04823 21.6037 0.951475 21.7387 0.872725L21.984 0.782725L22.3665 0.625225H23.3137C24.1597 0.712975 24.9045 1.21923 25.2937 1.97523L30.2865 12.0327C30.6465 12.7685 31.3462 13.2792 32.154 13.403L43.3365 15.0252C44.2815 15.1602 45.0712 15.8127 45.384 16.7127C45.6787 17.615 45.4245 18.605 44.7315 19.2552L36.3165 27.2202Z" fill={rating >= 3 ? "#FDDA0D" : "#777979"}/>
                    </svg>
                    <svg onClick={() => setRating(4)} className="ml-4 cursor-pointer" width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.3165 27.2202C35.7337 27.785 35.466 28.6017 35.5987 29.4027L37.599 40.4727C37.7677 41.411 37.3717 42.3605 36.5865 42.9027C35.817 43.4652 34.7932 43.5327 33.954 43.0827L23.9887 37.8852C23.6422 37.7007 23.2575 37.6017 22.8637 37.5905H22.254C22.0425 37.622 21.8355 37.6895 21.6465 37.793L11.679 43.0152C11.1862 43.2627 10.6282 43.3505 10.0815 43.2627C8.74949 43.0107 7.86074 41.7417 8.07899 40.403L10.0815 29.333C10.2142 28.5252 9.9465 27.704 9.36374 27.1302L1.23899 19.2552C0.559494 18.596 0.323244 17.606 0.633744 16.7127C0.935244 15.8217 1.70474 15.1715 2.63399 15.0252L13.8165 13.403C14.667 13.3152 15.414 12.7977 15.7965 12.0327L20.724 1.93023C20.841 1.70522 20.9917 1.49823 21.174 1.32273L21.3765 1.16523C21.4822 1.04823 21.6037 0.951475 21.7387 0.872725L21.984 0.782725L22.3665 0.625225H23.3137C24.1597 0.712975 24.9045 1.21923 25.2937 1.97523L30.2865 12.0327C30.6465 12.7685 31.3462 13.2792 32.154 13.403L43.3365 15.0252C44.2815 15.1602 45.0712 15.8127 45.384 16.7127C45.6787 17.615 45.4245 18.605 44.7315 19.2552L36.3165 27.2202Z" fill={rating >= 4 ? "#FDDA0D" : "#777979"}/>
                    </svg>
                    <svg onClick={() => setRating(5)} className="ml-4 cursor-pointer" width="46" height="44" viewBox="0 0 46 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M36.3165 27.2202C35.7337 27.785 35.466 28.6017 35.5987 29.4027L37.599 40.4727C37.7677 41.411 37.3717 42.3605 36.5865 42.9027C35.817 43.4652 34.7932 43.5327 33.954 43.0827L23.9887 37.8852C23.6422 37.7007 23.2575 37.6017 22.8637 37.5905H22.254C22.0425 37.622 21.8355 37.6895 21.6465 37.793L11.679 43.0152C11.1862 43.2627 10.6282 43.3505 10.0815 43.2627C8.74949 43.0107 7.86074 41.7417 8.07899 40.403L10.0815 29.333C10.2142 28.5252 9.9465 27.704 9.36374 27.1302L1.23899 19.2552C0.559494 18.596 0.323244 17.606 0.633744 16.7127C0.935244 15.8217 1.70474 15.1715 2.63399 15.0252L13.8165 13.403C14.667 13.3152 15.414 12.7977 15.7965 12.0327L20.724 1.93023C20.841 1.70522 20.9917 1.49823 21.174 1.32273L21.3765 1.16523C21.4822 1.04823 21.6037 0.951475 21.7387 0.872725L21.984 0.782725L22.3665 0.625225H23.3137C24.1597 0.712975 24.9045 1.21923 25.2937 1.97523L30.2865 12.0327C30.6465 12.7685 31.3462 13.2792 32.154 13.403L43.3365 15.0252C44.2815 15.1602 45.0712 15.8127 45.384 16.7127C45.6787 17.615 45.4245 18.605 44.7315 19.2552L36.3165 27.2202Z" fill={rating >= 5 ? "#FDDA0D" : "#777979"}/>
                    </svg>
                </div>
            </div>
            <div
                className="P-5 text-[#023020] font-inter mt-5 bg-[#FCF4DB] p-5 rounded-xl"
            >
                <p className="font-bold text-2xl">Write your thoughts on the product</p>
                <textarea onChange={e => setReview(e.currentTarget.value)} className="w-full p-3 mt-3 bg-[#F4EBD0] rounded-xl text-[#777979] font-inter resize-none" id="" rows="5" placeholder="Write your thoughts here...">

                </textarea>
            </div>
            {/* <div
                className="P-5 text-[#023020] font-inter mt-5 bg-[#FCF4DB] p-5 rounded-xl"
            >
                <p className="font-bold text-2xl">Add photo</p>
                <div
                    className="mt-3 ml-4"
                >
                    <input className="hidden" type="file" id="addPhoto" />
                    <label htmlFor="addPhoto">
                        <svg width="99" height="91" viewBox="0 0 99 91" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M80.708 27.6667V18.75H71.7914V9.83335H80.708V0.916687H89.6247V9.83335H98.5414V18.75H89.6247V27.6667H80.708ZM9.37468 90.0833C6.9226 90.0833 4.82272 89.2095 3.07506 87.4619C1.32739 85.7142 0.455043 83.6158 0.458015 81.1667V27.6667C0.458015 25.2146 1.33185 23.1147 3.07952 21.3671C4.82718 19.6194 6.92557 18.747 9.37468 18.75H23.4184L31.6664 9.83335H58.4164V18.75H35.5674L27.4309 27.6667H9.37468V81.1667H80.708V41.0417H89.6247V81.1667C89.6247 83.6188 88.7509 85.7186 87.0032 87.4663C85.2555 89.214 83.1571 90.0863 80.708 90.0833H9.37468ZM45.0414 74.4792C50.6143 74.4792 55.352 72.5279 59.2545 68.6254C63.157 64.7229 65.1068 59.9866 65.1039 54.4167C65.1039 48.8438 63.1526 44.106 59.2501 40.2035C55.3475 36.301 50.6113 34.3512 45.0414 34.3542C39.4684 34.3542 34.7307 36.3054 30.8282 40.208C26.9257 44.1105 24.9759 48.8467 24.9789 54.4167C24.9789 59.9896 26.9301 64.7273 30.8326 68.6298C34.7352 72.5324 39.4714 74.4822 45.0414 74.4792ZM45.0414 65.5625C41.9205 65.5625 39.2827 64.4851 37.1278 62.3302C34.9729 60.1754 33.8955 57.5375 33.8955 54.4167C33.8955 51.2958 34.9729 48.658 37.1278 46.5031C39.2827 44.3483 41.9205 43.2709 45.0414 43.2709C48.1622 43.2709 50.8 44.3483 52.9549 46.5031C55.1098 48.658 56.1872 51.2958 56.1872 54.4167C56.1872 57.5375 55.1098 60.1754 52.9549 62.3302C50.8 64.4851 48.1622 65.5625 45.0414 65.5625Z" fill="#023020"/>
                        </svg>
                    </label>
                </div>
            </div> */}
            <button
                className="p-3 mt-5 mx-auto text-xl bg-[#8A9A5B] text-[#3F3533] w-1/2 rounded-xl"
                onClick={onSubmit}
            >
                Submit review
            </button>
        </main>
    )
}